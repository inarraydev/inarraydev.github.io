import{y as A,j as g,z as R,m as F,l as I,n as w,D as O,R as q,S as L,U as Q,V as B}from"./index-DIkneJOC.js";function H(e){let n=!1,u,r;function l(){r=arguments,n!==!0&&(n=!0,u=requestAnimationFrame(()=>{e.apply(this,r),r=void 0,n=!1}))}return l.cancel=()=>{window.cancelAnimationFrame(u),n=!1},l}const{passive:b}=B,M=A({name:"QParallax",props:{src:String,height:{type:Number,default:500},speed:{type:Number,default:1,validator:e=>e>=0&&e<=1},scrollTarget:{default:void 0},onScroll:Function},setup(e,{slots:n,emit:u}){const r=g(0),l=g(null),T=g(null),z=g(null);let i,t,E,f,s,o;R(()=>e.height,()=>{i===!0&&c()}),R(()=>e.scrollTarget,()=>{i===!0&&(S(),x())});let m=a=>{r.value=a,e.onScroll!==void 0&&u("scroll",a)};function c(){let a,d,h;o===window?(a=0,h=d=window.innerHeight):(a=q(o).top,d=L(o),h=a+d);const y=q(l.value).top,_=y+e.height;if(s!==void 0||_>a&&y<h){const P=(h-y)/(e.height+d);v((E-e.height)*P*e.speed),m(P)}}let v=a=>{t.style.transform=`translate3d(-50%,${Math.round(a)}px,0)`};function p(){E=t.naturalHeight||t.videoHeight||L(t),i===!0&&c()}function x(){i=!0,o=Q(l.value,e.scrollTarget),o.addEventListener("scroll",c,b),window.addEventListener("resize",f,b),c()}function S(){i===!0&&(i=!1,o.removeEventListener("scroll",c,b),window.removeEventListener("resize",f,b),o=void 0,v.cancel(),m.cancel(),f.cancel())}return F(()=>{v=H(v),m=H(m),f=H(p),t=n.media!==void 0?T.value.children[0]:z.value,t.onload=t.onloadstart=t.loadedmetadata=p,p(),t.style.display="initial",window.IntersectionObserver!==void 0?(s=new IntersectionObserver(a=>{(a[0].isIntersecting===!0?x:S)()}),s.observe(l.value)):x()}),I(()=>{S(),s!==void 0&&s.disconnect(),t.onload=t.onloadstart=t.loadedmetadata=null}),()=>w("div",{ref:l,class:"q-parallax",style:{height:`${e.height}px`}},[w("div",{ref:T,class:"q-parallax__media absolute-full"},n.media!==void 0?n.media():[w("img",{ref:z,src:e.src})]),w("div",{class:"q-parallax__content absolute-full column flex-center"},n.content!==void 0?n.content({percentScrolled:r.value}):O(n.default))])}});export{M as Q};
