import{h as k,a8 as de,a9 as fe,A as y,aa as me,ab as ve,ac as ge,x as v,I as he,m as W,n as ye,q as N,u as V,i as xe,g as be,k as I,T as K,B as we,C as ke}from"./index-DLclWXkx.js";import{G as R,p as F,H as qe,I as pe,j as Te,k as Ee,l as Se,m as Be,J as Ce,n as _e,K as De}from"./footer-0soKfe_u.js";function Fe(e){for(e=e.parent;e!=null;){if(e.type.name==="QGlobalDialog")return!0;if(e.type.name==="QDialog"||e.type.name==="QMenu")return!1;e=e.parent}return!1}function Pe(e,i,o,s){const a=k(!1),u=k(!1);let l=null;const c={},r=s==="dialog"&&Fe(e);function d(m){if(m===!0){R(c),u.value=!0;return}u.value=!1,a.value===!1&&(r===!1&&l===null&&(l=ve(!1,s)),a.value=!0,F.push(e.proxy),qe(c))}function f(m){if(u.value=!1,m!==!0)return;R(c),a.value=!1;const b=F.indexOf(e.proxy);b!==-1&&F.splice(b,1),l!==null&&(ge(l),l=null)}return de(()=>{f(!0)}),e.proxy.__qPortal=!0,fe(e.proxy,"contentEl",()=>i.value),{showPortal:d,hidePortal:f,portalIsActive:a,portalIsAccessible:u,renderPortal:()=>r===!0?o():a.value===!0?[y(me,{to:l},o())]:void 0}}const $e={transitionShow:{type:String,default:"fade"},transitionHide:{type:String,default:"fade"},transitionDuration:{type:[String,Number],default:300}};function He(e,i=()=>{},o=()=>{}){return{transitionProps:v(()=>{const s=`q-transition--${e.transitionShow||i()}`,a=`q-transition--${e.transitionHide||o()}`;return{appear:!0,enterFromClass:`${s}-enter-from`,enterActiveClass:`${s}-enter-active`,enterToClass:`${s}-enter-to`,leaveFromClass:`${a}-leave-from`,leaveActiveClass:`${a}-leave-active`,leaveToClass:`${a}-leave-to`}}),transitionStyle:v(()=>`--q-transition-duration: ${e.transitionDuration}ms`)}}function Oe(){let e;const i=N();function o(){e=void 0}return he(o),W(o),{removeTick:o,registerTick(s){e=s,ye(()=>{e===s&&(pe(i)===!1&&e(),e=void 0)})}}}const g=[];let x;function ze(e){x=e.keyCode===27}function Le(){x===!0&&(x=!1)}function Me(e){x===!0&&(x=!1,xe(e,27)===!0&&g[g.length-1](e))}function U(e){window[e]("keydown",ze),window[e]("blur",Le),window[e]("keyup",Me),x=!1}function Ae(e){V.is.desktop===!0&&(g.push(e),g.length===1&&U("addEventListener"))}function j(e){const i=g.indexOf(e);i>-1&&(g.splice(i,1),g.length===0&&U("removeEventListener"))}const h=[];function J(e){h[h.length-1](e)}function Ie(e){V.is.desktop===!0&&(h.push(e),h.length===1&&document.body.addEventListener("focusin",J))}function G(e){const i=h.indexOf(e);i>-1&&(h.splice(i,1),h.length===0&&document.body.removeEventListener("focusin",J))}let T=0;const Ke={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},Q={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]},Ge=be({name:"QDialog",inheritAttrs:!1,props:{...Te,...$e,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,position:{type:String,default:"standard",validator:e=>e==="standard"||["top","bottom","left","right"].includes(e)}},emits:[...Ee,"shake","click","escapeKey"],setup(e,{slots:i,emit:o,attrs:s}){const a=N(),u=k(null),l=k(!1),c=k(!1);let r=null,d=null,f,m;const b=v(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:P}=De(),{registerTimeout:$}=Se(),{registerTick:X,removeTick:H}=Oe(),{transitionProps:Y,transitionStyle:O}=He(e,()=>Q[e.position][0],()=>Q[e.position][1]),{showPortal:z,hidePortal:L,portalIsAccessible:Z,renderPortal:ee}=Pe(a,u,ce,"dialog"),{hide:q}=Be({showing:l,hideOnRouteChange:b,handleShow:le,handleHide:se,processOnMount:!0}),{addToHistory:te,removeFromHistory:ne}=Ce(l,q,b),oe=v(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${Ke[e.position]}`+(c.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),p=v(()=>l.value===!0&&e.seamless!==!0),ie=v(()=>e.autoClose===!0?{onClick:ue}:{}),ae=v(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${p.value===!0?"modal":"seamless"}`,s.class]);I(()=>e.maximized,t=>{l.value===!0&&B(t)}),I(p,t=>{P(t),t===!0?(Ie(C),Ae(S)):(G(C),j(S))});function le(t){te(),d=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,B(e.maximized),z(),c.value=!0,e.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),X(w)):H(),$(()=>{if(a.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:n,bottom:_}=document.activeElement.getBoundingClientRect(),{innerHeight:A}=window,D=window.visualViewport!==void 0?window.visualViewport.height:A;n>0&&_>D/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-D,_>=A?1/0:Math.ceil(document.scrollingElement.scrollTop+_-D/2))),document.activeElement.scrollIntoView()}m=!0,u.value.click(),m=!1}z(!0),c.value=!1,o("show",t)},e.transitionDuration)}function se(t){H(),ne(),M(!0),c.value=!0,L(),d!==null&&(((t&&t.type.indexOf("key")===0?d.closest('[tabindex]:not([tabindex^="-"])'):void 0)||d).focus(),d=null),$(()=>{L(!0),c.value=!1,o("hide",t)},e.transitionDuration)}function w(t){_e(()=>{let n=u.value;n===null||n.contains(document.activeElement)===!0||(n=(t!==""?n.querySelector(t):null)||n.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||n.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||n.querySelector("[autofocus], [data-autofocus]")||n,n.focus({preventScroll:!0}))})}function E(t){t&&typeof t.focus=="function"?t.focus({preventScroll:!0}):w(),o("shake");const n=u.value;n!==null&&(n.classList.remove("q-animate--scale"),n.classList.add("q-animate--scale"),r!==null&&clearTimeout(r),r=setTimeout(()=>{r=null,u.value!==null&&(n.classList.remove("q-animate--scale"),w())},170))}function S(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&E():(o("escapeKey"),q()))}function M(t){r!==null&&(clearTimeout(r),r=null),(t===!0||l.value===!0)&&(B(!1),e.seamless!==!0&&(P(!1),G(C),j(S))),t!==!0&&(d=null)}function B(t){t===!0?f!==!0&&(T<1&&document.body.classList.add("q-body--dialog"),T++,f=!0):f===!0&&(T<2&&document.body.classList.remove("q-body--dialog"),T--,f=!1)}function ue(t){m!==!0&&(q(t),o("click",t))}function re(t){e.persistent!==!0&&e.noBackdropDismiss!==!0?q(t):e.noShake!==!0&&E()}function C(t){e.allowFocusOutside!==!0&&Z.value===!0&&ke(u.value,t.target)!==!0&&w('[tabindex]:not([tabindex="-1"])')}Object.assign(a.proxy,{focus:w,shake:E,__updateRefocusTarget(t){d=t||null}}),W(M);function ce(){return y("div",{role:"dialog","aria-modal":p.value===!0?"true":"false",...s,class:ae.value},[y(K,{name:"q-transition--fade",appear:!0},()=>p.value===!0?y("div",{class:"q-dialog__backdrop fixed-full",style:O.value,"aria-hidden":"true",tabindex:-1,onClick:re}):null),y(K,Y.value,()=>l.value===!0?y("div",{ref:u,class:oe.value,style:O.value,tabindex:-1,...ie.value},we(i.default)):null)])}return ee}});export{Ge as Q,Oe as a,He as b,Pe as c,Ie as d,j as e,Ae as f,G as r,$e as u};
